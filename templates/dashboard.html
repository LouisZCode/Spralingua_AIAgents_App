{% extends "base.html" %}

{% block title %}Dashboard - Spralingua{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v={{ timestamp }}">
{% endblock %}

{% block content %}
<!-- Pass saved progress data to JavaScript -->
{% if user_progress %}
<script>
    window.savedProgress = {
        input_language: "{{ user_progress.input_language }}",
        target_language: "{{ user_progress.target_language }}",
        current_level: "{{ user_progress.current_level }}"
    };
</script>
{% endif %}

<div class="dashboard-container">
    <div class="dashboard-header">
        <h1 class="dashboard-title" data-translate="welcome">Welcome back!</h1>
        <p class="dashboard-subtitle" data-translate="choose_path">Choose your learning path</p>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>

    <div class="selection-container">
        <!-- Input Language Section -->
        <div class="language-section">
            <h2 class="section-title" data-translate="i_speak">I speak...</h2>
            <div class="language-grid" id="input-languages">
                <div class="language-card" data-lang="english">
                    <img src="{{ url_for('static', filename='images/flags/english.png') }}" alt="English" class="flag-image">
                    <span class="language-name" data-translate="lang_english">English</span>
                </div>
                <div class="language-card" data-lang="german">
                    <img src="{{ url_for('static', filename='images/flags/german.png') }}" alt="German" class="flag-image">
                    <span class="language-name" data-translate="lang_german">German</span>
                </div>
                <div class="language-card" data-lang="spanish">
                    <img src="{{ url_for('static', filename='images/flags/spanish.png') }}" alt="Spanish" class="flag-image">
                    <span class="language-name" data-translate="lang_spanish">Spanish</span>
                </div>
                <div class="language-card" data-lang="portuguese">
                    <img src="{{ url_for('static', filename='images/flags/portuguese.png') }}" alt="Portuguese" class="flag-image">
                    <span class="language-name" data-translate="lang_portuguese">Portuguese</span>
                </div>
            </div>
        </div>

        <!-- Target Language Section -->
        <div class="language-section">
            <h2 class="section-title" data-translate="i_want_learn">I want to learn...</h2>
            <div class="language-grid" id="target-languages">
                <div class="language-card" data-lang="english">
                    <img src="{{ url_for('static', filename='images/flags/english.png') }}" alt="English" class="flag-image">
                    <span class="language-name" data-translate="lang_english">English</span>
                </div>
                <div class="language-card" data-lang="german">
                    <img src="{{ url_for('static', filename='images/flags/german.png') }}" alt="German" class="flag-image">
                    <span class="language-name" data-translate="lang_german">German</span>
                </div>
                <div class="language-card" data-lang="spanish">
                    <img src="{{ url_for('static', filename='images/flags/spanish.png') }}" alt="Spanish" class="flag-image">
                    <span class="language-name" data-translate="lang_spanish">Spanish</span>
                </div>
                <div class="language-card" data-lang="portuguese">
                    <img src="{{ url_for('static', filename='images/flags/portuguese.png') }}" alt="Portuguese" class="flag-image">
                    <span class="language-name" data-translate="lang_portuguese">Portuguese</span>
                </div>
            </div>
        </div>

        <!-- Level Selection Section -->
        <div class="language-section">
            <h2 class="section-title" data-translate="my_level">My current level is...</h2>
            <div class="level-grid" id="level-selection">
                <div class="level-card" data-level="A1">
                    <div class="level-badge" data-translate="level_a1">A1</div>
                    <span class="level-description" data-translate="a1_desc">Beginner - Basic phrases and vocabulary</span>
                </div>
                <div class="level-card" data-level="A2">
                    <div class="level-badge" data-translate="level_a2">A2</div>
                    <span class="level-description" data-translate="a2_desc">Elementary - Simple everyday conversations</span>
                </div>
                <div class="level-card" data-level="B1">
                    <div class="level-badge" data-translate="level_b1">B1</div>
                    <span class="level-description" data-translate="b1_desc">Intermediate - Can handle most situations</span>
                </div>
                <div class="level-card" data-level="B2">
                    <div class="level-badge" data-translate="level_b2">B2</div>
                    <span class="level-description" data-translate="b2_desc">Upper-Intermediate - Fluent in complex topics</span>
                </div>
            </div>
        </div>

        <!-- Selection Display -->
        <div class="selection-display" id="selection-display" style="display: none;">
            <p class="selection-text">
                Learning <span id="target-display">---</span> from <span id="input-display">---</span> at <span id="level-display">---</span> level
            </p>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="error-message" style="display: none;">
            <p>You cannot select the same language for both input and target!</p>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn-continue" id="continue-btn" disabled data-translate="continue_btn">
                Continue
            </button>
        </div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/dashboard.js') }}?v={{ timestamp }}"></script>
{% endblock %}